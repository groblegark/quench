# Go Language Adapter Roadmap

This roadmap covers adding Go (golang) language support to quench.
Phases use 45x numbering (between Shell 4xx and Agents 5xx).

## Dependencies from .0-outline

| This Phase | Blocked By | Reason |
|------------|------------|--------|
| 451 | Phase 201 | Requires adapter trait definition |
| 455 | Phase 201 | Requires adapter trait definition |
| 460 | Phase 205-220 | Requires escapes check framework |
| 465 | Phase 205-220 | Requires escapes check framework |
| 470 | Phase 705-720 | Requires tests check correlation |
| 475 | Phase 915 | Requires test runner framework |
| 480 | Phase 1005-1020 | Requires build check framework |
| 485 | Phase 1505-1510 | Requires init command profile system |

---

## Phase 451: Go Adapter - Specs

_Blocked by: Phase 201 (Generic Language Adapter)_

- [x] Spec: auto-detected when go.mod present
- [x] Spec: default source pattern **/*.go
- [x] Spec: default test pattern **/*_test.go
- [x] Spec: default ignores vendor/
- [x] Spec: detects module name from go.mod
- [x] Spec: detects packages from directory structure
- [x] Spec: unsafe.Pointer without // SAFETY: comment fails
- [x] Spec: //go:linkname without // LINKNAME: comment fails
- [x] Spec: //go:noescape without // NOESCAPE: comment fails
- [x] Spec: //nolint without comment fails (when configured)
- [x] Spec: lint config changes with source changes fails standalone policy

## Phase 455: Go Adapter - Detection

_Blocked by: Phase 201 (Generic Language Adapter)_

- [x] go.mod detection
- [x] Default source patterns (**/*.go)
- [x] Default test patterns (**/*_test.go)
- [x] Default ignore patterns (vendor/)
- [x] Module name extraction from go.mod
- [x] Package enumeration from directory structure
- [x] Integration test: detect packages in fixtures/go-project

## Phase 457: Go Test Fixture

_Blocked by: Phase 010 (Test Fixtures) - can run in parallel_

- [x] fixtures/go-simple/ - small Go project with go.mod, cmd/, pkg/
- [x] fixtures/go-multi/ - multi-package Go project
- [x] Add Go violations to fixtures/violations/
- [x] Fixture README updates

## Phase 460: Go Adapter - Escapes

_Blocked by: Phase 205-220 (Escapes Check)_

- [x] Default unsafe.Pointer pattern
- [x] Default //go:linkname pattern
- [x] Default //go:noescape pattern
- [x] SAFETY comment requirement for unsafe.Pointer
- [x] LINKNAME comment requirement for //go:linkname
- [x] NOESCAPE comment requirement for //go:noescape
- [x] Unit tests for Go escape patterns

## Phase 465: Go Adapter - Suppress

_Blocked by: Phase 205-220 (Escapes Check)_

- [x] //nolint detection (single linter)
- [x] //nolint:linter1,linter2 detection (multiple)
- [x] //nolint detection (all linters, discouraged)
- [x] Suppress check levels (forbid/comment/allow)
- [x] Custom comment pattern for suppress
- [x] Per-code allow list (no comment needed)
- [x] Per-code forbid list (never allowed)
- [x] Separate source vs test suppress policies
- [x] Unit tests for //nolint parsing

## Phase 470: Go Adapter - Policy

_Blocked by: Phase 325 (Rust Adapter - Policy) for pattern, Phase 705-720 for tests correlation_

- [x] lint_changes = "standalone" enforcement
- [x] Lint config file detection (.golangci.yml, .golangci.yaml, .golangci.toml)
- [x] Mixed change detection (lint config + source in same branch)
- [x] Standalone PR requirement violation

### Checkpoint: Go Adapter Basic Complete
- [x] `quench check` on fixtures/go-simple with no config produces useful output
- [x] `quench check` on fixtures/go-multi detects all packages
- [x] Go-specific escapes detected in fixtures/violations
- [x] Exact output tests for Go adapter output

---

## Phase 475: Go Test Runner

_Blocked by: Phase 915 (Test Runners - Framework)_

- [ ] go test -json ./... execution
- [ ] JSON output parsing (test2json format)
- [ ] Per-test timing extraction
- [ ] Pass/fail status extraction
- [ ] Test count metrics
- [ ] Package-level aggregation
- [ ] Integration test: run go tests on fixtures/go-simple

## Phase 477: Go Test Runner - Coverage

_Blocked by: Phase 475 (Go Test Runner)_

- [ ] go test -coverprofile=coverage.out ./... execution
- [ ] Coverage profile parsing
- [ ] Line coverage percentage extraction
- [ ] Per-package coverage data
- [ ] Coverage merging across packages
- [ ] Integration with coverage aggregation

### Checkpoint: Go Test Runner Complete
- [ ] `quench check --ci --tests` runs go test on Go projects
- [ ] Per-test timing extracted from JSON output
- [ ] Coverage metrics collected
- [ ] Exact output tests for Go test runner output

---

## Phase 480: Go Build Metrics

_Blocked by: Phase 1005-1020 (Build Check)_

- [ ] Build target detection from cmd/**/main.go
- [ ] go build -ldflags="-s -w" execution
- [ ] Binary file size measurement
- [ ] Cold build execution (go clean -cache && go build)
- [ ] Cold build timing
- [ ] Hot build execution (touch && go build)
- [ ] Hot build timing
- [ ] Per-target metrics

### Checkpoint: Go Build Metrics Complete
- [ ] `quench check --ci --build` measures Go binary size and build time
- [ ] Exact output tests for Go build output

---

## Phase 485: Go Profile Defaults

_Blocked by: Phase 1505-1510 (Init Command - Profile Detection/Config Generation)_

- [ ] Go profile defaults struct (escapes, suppress, policy)
- [ ] Profile enum includes "go" / "golang"
- [ ] Auto-detection: go.mod → golang profile
- [ ] Go profile defaults application in init

## Phase 487: Go Landing the Plane

_Blocked by: Phase 1515 (Init Command - Landing the Plane)_

- [ ] Go Landing the Plane checklist items:
  - `go fmt ./...`
  - `go vet ./...`
  - `golangci-lint run` (if .golangci.yml exists)
  - `go test ./...`
  - `go build ./...`
- [ ] Checklist merging with base items

### Checkpoint: Go Init Complete
- [ ] `quench init` on fixtures/go-simple auto-detects golang profile
- [ ] `quench init --profile golang` creates Go-specific config
- [ ] `quench init --profile golang,claude` populates Landing the Plane with Go items

---

## Summary: Blocking Relationships

```
Phase 201 (Generic Adapter)
    ├── Phase 451 (Go Specs)
    └── Phase 455 (Go Detection)
            └── Phase 457 (Go Fixture) [parallel]

Phase 205-220 (Escapes Check)
    ├── Phase 460 (Go Escapes)
    └── Phase 465 (Go Suppress)

Phase 325 (Rust Policy) + Phase 705-720 (Tests Correlation)
    └── Phase 470 (Go Policy)

Phase 915 (Test Runner Framework)
    └── Phase 475 (Go Test Runner)
            └── Phase 477 (Go Coverage)

Phase 1005-1020 (Build Check)
    └── Phase 480 (Go Build Metrics)

Phase 1505-1510 (Init Profile System)
    └── Phase 485 (Go Profile Defaults)
            └── Phase 487 (Go Landing the Plane)
```

## Parallel Execution Opportunities

These Go phases can run in parallel with their non-Go counterparts:

| Go Phase | Can Parallel With |
|----------|-------------------|
| 451-455 | Phase 401-420 (Shell Adapter) |
| 457 | Any fixture work |
| 460-465 | Any escapes work after framework done |
| 475-477 | Phase 920-930 (Cargo/Bats runners) |
| 480 | Phase 1010-1015 (Rust build metrics) |
| 485-487 | Phase 1510 (other profile defaults) |
